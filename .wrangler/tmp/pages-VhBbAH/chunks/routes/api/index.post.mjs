import{d as t,a as e,c as a}from"../../nitro/nitro.mjs";import{g as s,u as r,e as o}from"../../_/db.mjs";import"node:events";import"node:buffer";import"node:process";import"cloudflare:workers";import"node:timers";const i=t(async t=>{try{const i=await e(t);if(!i.email||!i.name)throw a({statusCode:400,statusMessage:"邮箱和姓名为必填项"});const n=s(t);if((await n.select().from(r).where(o(r.email,i.email)).limit(1)).length>0)throw a({statusCode:409,statusMessage:"该邮箱已被注册"});const m={email:i.email,name:i.name,avatar:i.avatar||null,createdAt:new Date,updatedAt:new Date};return{success:!0,data:(await n.insert(r).values(m).returning())[0],message:"用户创建成功"}}catch(t){if(t instanceof Error&&"statusCode"in t)throw t;throw a({statusCode:500,statusMessage:"创建用户失败",data:{error:t instanceof Error?t.message:"未知错误"}})}});export{i as default};
//# sourceMappingURL=index.post.mjs.map
